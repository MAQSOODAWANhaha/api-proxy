# å‰ç«¯APIæ¥å£å®¡æŸ¥æŠ¥å‘Š

## ğŸ“‹ å®¡æŸ¥æ¦‚å†µ

**å®¡æŸ¥æ—¶é—´**: 2025-07-26  
**å®¡æŸ¥èŒƒå›´**: å‰ç«¯æ‰€æœ‰APIè°ƒç”¨ä¸åç«¯è·¯ç”±å¯¹æ¯”  
**ä¸»è¦å‘ç°**: å‘ç°å¤šå¤„APIè·¯å¾„ä¸åŒ¹é…å’Œç¼ºå¤±æ¥å£é—®é¢˜

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### 1. Provider Keys APIè·¯å¾„é”™è¯¯
- **é—®é¢˜**: å‰ç«¯ä½¿ç”¨ `/api/provider-keys`ï¼Œåç«¯æä¾› `/provider-keys`
- **ä¿®å¤**: 
  - åœ¨åç«¯æ·»åŠ äº†ç¼ºå¤±çš„provider-keysè·¯ç”±
  - ä¿®æ­£å‰ç«¯APIè°ƒç”¨è·¯å¾„ï¼Œç§»é™¤å¤šä½™çš„ `/api` å‰ç¼€
- **æ¶‰åŠæ–‡ä»¶**: 
  - `src/management/server.rs` (æ·»åŠ è·¯ç”±)
  - `frontend/src/api/apiKey.ts` (ä¿®æ­£è·¯å¾„)

## ğŸ“Š APIæ¥å£å¯¹æ¯”è¡¨

| å‰ç«¯APIæ–‡ä»¶ | å‰ç«¯è°ƒç”¨è·¯å¾„ | åç«¯è·¯ç”± | çŠ¶æ€ | å¤‡æ³¨ |
|------------|-------------|---------|------|------|
| `auth.ts` | `/auth/login` | `/auth/login` | âœ… åŒ¹é… | ç™»å½•æ¥å£ |
| `health.ts` | `/health/servers` | `/health/servers` | âœ… åŒ¹é… | å¥åº·æ£€æŸ¥ |
| `statistics.ts` | `/statistics/overview` | `/statistics/overview` | âœ… åŒ¹é… | ç»Ÿè®¡æ¦‚è§ˆ |
| `statistics.ts` | `/statistics/requests` | `/statistics/requests` | âœ… åŒ¹é… | è¯·æ±‚ç»Ÿè®¡ |
| `serviceKey.ts` | `/provider-types` | `/provider-types` | âœ… åŒ¹é… | æä¾›å•†ç±»å‹ |
| `serviceKey.ts` | `/api-keys` | `/api-keys` | âœ… åŒ¹é… | æœåŠ¡å¯†é’¥ |
| `serviceKey.ts` | `/api-keys/{id}` | `/api-keys/{id}` | âœ… åŒ¹é… | æœåŠ¡å¯†é’¥æ“ä½œ |
| `serviceKey.ts` | `/api-keys/{id}/revoke` | `/api-keys/{id}/revoke` | âœ… åŒ¹é… | å¯†é’¥æ’¤é”€ |
| `apiKey.ts` | `/provider-keys` | `/provider-keys` | âœ… å·²ä¿®å¤ | æä¾›å•†å¯†é’¥ |
| `apiKey.ts` | `/provider-keys/{id}` | `/provider-keys/{id}` | âœ… å·²ä¿®å¤ | æä¾›å•†å¯†é’¥æ“ä½œ |
| `loadbalancer.ts` | `/loadbalancer/*` | `/loadbalancer/*` | âœ… åŒ¹é… | è´Ÿè½½å‡è¡¡ |

## ğŸ” å‘ç°çš„APIç±»å‹å·®å¼‚

### 1. å“åº”æ•°æ®æ ¼å¼ä¸ä¸€è‡´
- **å‰ç«¯æœŸæœ›**: å¤šç§å“åº”æ ¼å¼ (`data`, `api_keys`, `provider_keys`)
- **åç«¯å®é™…**: éœ€è¦ç¡®è®¤ç»Ÿä¸€çš„å“åº”æ ¼å¼
- **å»ºè®®**: åˆ¶å®šç»Ÿä¸€çš„APIå“åº”æ ¼å¼è§„èŒƒ

### 2. Mockæ•°æ®ä½¿ç”¨è¿‡å¤š
- **é—®é¢˜**: `user.ts`, `requestLog.ts`, `health.ts` å¤§é‡ä½¿ç”¨Mockæ•°æ®
- **å½±å“**: æ— æ³•ä¸çœŸå®åç«¯æ•°æ®åŒæ­¥
- **å»ºè®®**: é€æ­¥æ›¿æ¢ä¸ºçœŸå®APIè°ƒç”¨

## ğŸ¯ å¾…å®ç°çš„åç«¯æ¥å£

### 1. ç”¨æˆ·ç®¡ç†æ¥å£
```
GET  /users/profile     - è·å–ç”¨æˆ·æ¡£æ¡ˆ
PUT  /users/profile     - æ›´æ–°ç”¨æˆ·æ¡£æ¡ˆ  
POST /users/password    - ä¿®æ”¹å¯†ç 
```

### 2. è¯·æ±‚æ—¥å¿—æ¥å£
```
GET /logs/requests      - è·å–è¯·æ±‚æ—¥å¿—åˆ—è¡¨
GET /logs/requests/{id} - è·å–è¯·æ±‚è¯¦æƒ…
```

### 3. ç³»ç»Ÿä¿¡æ¯æ¥å£ (å·²å­˜åœ¨ä½†å‰ç«¯æœªä½¿ç”¨)
```
GET /system/info        - è·å–ç³»ç»Ÿä¿¡æ¯
GET /system/metrics     - è·å–ç³»ç»ŸæŒ‡æ ‡
```

## âœ¨ æ”¹è¿›å»ºè®®

### 1. ç»Ÿä¸€APIå“åº”æ ¼å¼
```typescript
interface ApiResponse<T> {
  success: boolean
  data: T
  message?: string
  code?: number
  timestamp?: string
}
```

### 2. å¢å¼ºé”™è¯¯å¤„ç†
- å‰ç«¯å·²åœ¨ `api/index.ts` ä¸­å¢åŠ äº†ç»Ÿä¸€é”™è¯¯å¤„ç†
- å»ºè®®åç«¯è¿”å›æ ‡å‡†åŒ–é”™è¯¯ç å’Œæ¶ˆæ¯

### 3. ç±»å‹å®‰å…¨
- å»ºè®®ä½¿ç”¨OpenAPI/Swaggerç”Ÿæˆç±»å‹å®šä¹‰
- ç¡®ä¿å‰åç«¯ç±»å‹å®šä¹‰ä¸€è‡´

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **çŸ­æœŸ** (ç«‹å³æ‰§è¡Œ):
   - âœ… ä¿®å¤provider-keys APIè·¯å¾„ (å·²å®Œæˆ)
   - å®ç°ç”¨æˆ·ç®¡ç†ç›¸å…³åç«¯æ¥å£
   - å®ç°è¯·æ±‚æ—¥å¿—ç›¸å…³åç«¯æ¥å£

2. **ä¸­æœŸ** (æœ¬å‘¨å†…):
   - ç»Ÿä¸€APIå“åº”æ ¼å¼
   - æ›¿æ¢Mockæ•°æ®ä¸ºçœŸå®APIè°ƒç”¨
   - æ·»åŠ APIæ–‡æ¡£

3. **é•¿æœŸ** (æŒç»­æ”¹è¿›):
   - å¼•å…¥APIç‰ˆæœ¬ç®¡ç†
   - å®ç°æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•
   - å»ºç«‹å‰åç«¯æ¥å£å¥‘çº¦æµ‹è¯•

## ğŸ“ æŠ€æœ¯å€ºåŠ¡

1. **é«˜ä¼˜å…ˆçº§**:
   - Mockæ•°æ®è¿‡å¤šï¼Œå½±å“å¼€å‘å’Œæµ‹è¯•
   - APIå“åº”æ ¼å¼ä¸ç»Ÿä¸€

2. **ä¸­ä¼˜å…ˆçº§**:
   - ç¼ºå°‘æ¥å£æ–‡æ¡£
   - é”™è¯¯å¤„ç†å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–

3. **ä½ä¼˜å…ˆçº§**:
   - è€ƒè™‘å¼•å…¥GraphQLæˆ–gRPC
   - APIæ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜ç­–ç•¥