# 调度策略 API 文档

## 概述

本文档描述了调度策略相关的接口，用于获取系统支持的负载均衡调度策略列表。该接口主要用于前端下拉选择器的数据源。

## 认证

所有接口都需要用户认证。

---

## 获取调度策略列表

### 接口信息
- **请求路由**: `GET /api/provider-types/scheduling-strategies`
- **请求方法**: GET
- **作用**: 获取系统支持的所有负载均衡调度策略列表

### 筛选参数
无

### 返回值
```json
{
    "success": true,
    "data": {
        "scheduling_strategies": [
            {
                "value": "round_robin",
                "label": "轮询调度",
                "description": "按顺序轮流分配请求到各个上游服务器",
                "is_default": true
            },
            {
                "value": "weighted",
                "label": "权重调度",
                "description": "根据权重比例分配请求到上游服务器",
                "is_default": false
            },
            {
                "value": "priority",
                "label": "优先级调度",
                "description": "优先使用高优先级的上游服务器",
                "is_default": false
            },
            {
                "value": "health_best",
                "label": "健康优选",
                "description": "优先选择健康状态最佳的上游服务器",
                "is_default": false
            }
        ]
    },
    "message": "操作成功",
    "timestamp": "2025-08-20T06:47:12.364806516Z"
}
```

### 字段说明
| 字段名 | 类型 | 描述 |
|--------|------|------|
| value | string | 调度策略内部标识值（用于API请求） |
| label | string | 调度策略显示名称（用于前端显示） |
| description | string | 调度策略详细描述 |
| is_default | bool | 是否为默认策略 |

---

## 调度策略详细说明

### round_robin（轮询调度）
- **适用场景**: 上游服务器性能相近的情况
- **特点**: 简单公平，每个服务器按顺序获得相等的请求机会
- **优势**: 实现简单，负载分布均匀
- **劣势**: 不考虑服务器性能差异

### weighted（权重调度）
- **适用场景**: 上游服务器性能不同的情况
- **特点**: 根据权重比例分配请求
- **优势**: 可以根据服务器性能调整负载分配
- **劣势**: 需要手动配置权重值

### priority（优先级调度）
- **适用场景**: 有主备服务器的情况
- **特点**: 优先使用高优先级服务器，备用服务器作为故障转移
- **优势**: 确保重要请求使用最佳服务器
- **劣势**: 可能导致高优先级服务器过载


### health_best（健康优选）
- **适用场景**: 注重服务可用性的情况
- **特点**: 根据健康检查结果选择最佳服务器
- **优势**: 自动避开有问题的服务器
- **劣势**: 需要健康检查支持

---

## 通用响应格式

所有接口都遵循统一的响应格式：

```json
{
    "success": boolean,        // 操作是否成功
    "data": object,           // 具体数据内容
    "message": string,        // 操作结果消息
    "timestamp": string       // 响应时间戳（ISO 8601 格式）
}
```

## 错误处理

当请求失败时，响应格式如下：

```json
{
    "success": false,
    "data": null,
    "message": "错误描述信息",
    "timestamp": "2025-08-20T06:47:12.364806516Z"
}
```

### 常见错误码
- **401 Unauthorized**: 用户未认证
- **500 Internal Server Error**: 服务器内部错误

## 使用场景

该接口主要用于：
1. 前端下拉选择器的数据源
2. 创建API Key时选择调度策略
3. 编辑API Key时显示当前调度策略
4. 系统配置界面显示可用调度策略

## 注意事项

1. 该接口需要用户认证
2. 调度策略列表是静态配置，无需数据库查询
3. value字段用于API请求参数，label字段用于前端显示
4. is_default字段标识系统默认推荐的策略
5. 实际可用的调度策略可能因系统配置而异